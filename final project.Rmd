---
title: "Final Project"
author: "Muhammad Salman Al Farisi"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r}
library(tidyverse)
library(dplyr)
```

```{r}
taylor_album_songs <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-10-17/taylor_album_songs.csv')
taylor_all_songs <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-10-17/taylor_all_songs.csv')
taylor_albums <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-10-17/taylor_albums.csv')
```

## Choosing the top three and bottom three albums
```{r}
# 1. Top 5 albums with highest Metacritic score
top_5_metacritic <- taylor_albums %>%
  arrange(desc(metacritic_score)) %>%
  filter(!is.na(metacritic_score)) %>%
  slice(1:5) %>%
  select(album_name)

# 2. Bottom 5 albums with lowest Metacritic score
bottom_5_metacritic <- taylor_albums %>%
  arrange(metacritic_score) %>%
  filter(!is.na(metacritic_score)) %>% 
  slice(1:5) %>% 
  select(album_name)

# 3. Top 5 albums with highest user score
top_5_user <- taylor_albums %>%
  arrange(desc(user_score)) %>%
  filter(!is.na(user_score)) %>%  
  slice(1:5) %>%
  select(album_name)

# 4. Bottom 5 albums with lowest user score
bottom_5_user <- taylor_albums %>%
  arrange(user_score) %>%
  filter(!is.na(user_score)) %>%  
  slice(1:5) %>% 
  select(album_name)

# Find the intersection of top 5 Metacritic and top 5 user scores
top_intersection <- top_5_metacritic %>%
  semi_join(top_5_user, by = "album_name") %>%
  slice(1:3) %>%
  select(album_name)

# Find the intersection of bottom 5 Metacritic and bottom 5 user scores
bottom_intersection <- bottom_5_metacritic %>%
  semi_join(bottom_5_user, by = "album_name") %>%
  slice(1:3) %>%
  select(album_name)

# Print the intersections
print(top_intersection)
print(bottom_intersection)

# Top 3 are Red (Taylor's Version), folklore, evermore, 
# Bottom 3 are reputation, Fearless, 1989

# Note: Here we take into account both the metacritic_score and user_score for 
# deciding which are top three and bottom three.
```

## Cleaning the data (Melisa)
```{r}
taylor_all_songs$artist <- ifelse(taylor_all_songs$album_name == "Beautiful Eyes",
                                  "Taylor Swift", taylor_all_songs$artist)
```
```{r}
album <- left_join(taylor_album_songs, taylor_albums, by = "album_name") %>%
  select(album_name, ep = ep.x, album_release = album_release.x, track_number, track_name,
         artist, featuring, bonus_track, single_release, track_release, danceability,
         energy, key, loudness, mode, speechiness, acousticness, instrumentalness,
         liveness, valence, tempo, time_signature, duration_ms, explicit, key_name,
         mode_name, key_mode, metacritic_score, user_score)
```

## Checking Numerical Correlation (Kristine)
```{r}

```

## Checking Categorical correlation (Sandrina)
```{r}

```

## Checking Logical correlation (Salman)
```{r}
# The logical features are: ep, bonus_track, explicit
# I think the logical correlation can't be computed for this dataset because the
# score is based on albums and the features is based on songs, say I aggregate the
# features for each album, then it will becomes numerical feature instead of categorical
# Looking at the taylor_albums dataset, it's also impossible to do correlation test 
# since the data for TRUE ep has missing value for metacritic score and user_score
```

